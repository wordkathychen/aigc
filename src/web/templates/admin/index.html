{% extends "admin/base.html" %}

{% block title %}工作台 - AI文本生成器{% endblock %}

{% block page_title %}工作台{% endblock %}

{% set active_page = 'dashboard' %}

{% block content %}
<!-- 数据统计卡片 -->
<div class="row mt-3">
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-title">今日收入</div>
            <div class="stat-value">{{ today_income|default('0') }}</div>
            <div class="stat-desc">昨日: {{ yesterday_income|default('0') }} | 同比: {{ income_ratio|default('0%') }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-title">订单数量</div>
            <div class="stat-value">{{ today_orders|default('0') }}</div>
            <div class="stat-desc">昨日: {{ yesterday_orders|default('0') }} | 同比: {{ orders_ratio|default('0%') }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-title">新增用户</div>
            <div class="stat-value">{{ today_users|default('0') }}</div>
            <div class="stat-desc">昨日: {{ yesterday_users|default('0') }} | 同比: {{ users_ratio|default('0%') }}</div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="stat-card">
            <div class="stat-title">新增访问量</div>
            <div class="stat-value">{{ today_visits|default('0') }}</div>
            <div class="stat-desc">昨日: {{ yesterday_visits|default('0') }} | 同比: {{ visits_ratio|default('0%') }}</div>
        </div>
    </div>
</div>

<!-- 网站信息卡片 -->
<div class="row mt-3">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>版本信息</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <p><strong>网站名称:</strong></p>
                        <p><strong>当前版本:</strong></p>
                        <p><strong>PC端链接:</strong></p>
                    </div>
                    <div class="col-md-8">
                        <p>{{ site_name|default('AI文本系统') }}</p>
                        <p>{{ version|default('1.5.4') }}</p>
                        <p><a href="{{ site_url|default('#') }}" target="_blank">{{ site_url|default('https://example.com') }}</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>今日数据</h5>
                <span class="text-muted small">更新时间: {{ update_time|default(now) }}</span>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <h3>{{ today_income|default('0') }}</h3>
                        <p class="text-muted">今日收入</p>
                    </div>
                    <div class="col-md-3">
                        <h3>{{ today_orders|default('0') }}</h3>
                        <p class="text-muted">订单数量</p>
                    </div>
                    <div class="col-md-3">
                        <h3>{{ today_users|default('0') }}</h3>
                        <p class="text-muted">新增用户</p>
                    </div>
                    <div class="col-md-3">
                        <h3>{{ today_visits|default('0') }}</h3>
                        <p class="text-muted">新增访问量</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 常用功能 -->
<div class="row mt-3">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5>常用功能</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.content_list') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-file-alt"></i>
                                <div class="feature-title">写作类型</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.user_list') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-users"></i>
                                <div class="feature-title">用户管理</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.orders') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-shopping-cart"></i>
                                <div class="feature-title">订单管理</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.finance_overview') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-money-bill-wave"></i>
                                <div class="feature-title">财务中心</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.api_keys') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-key"></i>
                                <div class="feature-title">Key池管理</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('prompts.index') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-comment-alt"></i>
                                <div class="feature-title">提示词模板</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.settings_general') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-cog"></i>
                                <div class="feature-title">通知设置</div>
                            </div>
                        </a>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-3">
                        <a href="{{ url_for('admin.settings_general') }}" class="text-decoration-none">
                            <div class="feature-card">
                                <i class="fas fa-cogs"></i>
                                <div class="feature-title">网站设置</div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 图表 -->
<div class="row mt-3">
    <div class="col-md-6">
        <div class="chart-container">
            <div class="chart-title">访问量趋势图</div>
            <canvas id="visitChart"></canvas>
        </div>
    </div>
    <div class="col-md-6">
        <div class="chart-container">
            <div class="chart-title">销售额趋势图</div>
            <canvas id="salesChart"></canvas>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // 图表数据
    const chartData = {
        labels: ['2025/05/27', '2025/05/28', '2025/05/29', '2025/05/30', '2025/05/31', '2025/06/01', '2025/06/02', '2025/06/03', '2025/06/04', '2025/06/05', '2025/06/06', '2025/06/07', '2025/06/08', '2025/06/09', '2025/06/10'],
        visits: [0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0],
        sales: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    };
    
    $(document).ready(function() {
        // 初始化图表
        initCharts();
    });
</script>
{% endblock %} 