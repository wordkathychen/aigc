# AI Text Generator Pro

基于多种AI大模型API的智能文本生成与处理系统，提供论文生成、AI检测优化、格式规范化等多功能服务。支持大纲交互式编辑、学校模板选择、智能参考文献生成等功能。

## 主要功能

1. 论文智能生成
- 支持学术论文、综述论文、调研报告等多种类型
- 交互式大纲编辑（支持添加、修改、删除章节）
- 智能数据/表格生成（按需配置数据支持）
- 章节智能分配字数
- 学校模板选择与自定义上传
- 智能参考文献生成（支持GB/T 7714-2015等多种格式）
- 完整的论文结构（标题、中英文摘要、关键词、正文、参考文献、致谢）
- 实时预览和编辑功能

2. AI检测优化
- 支持多平台检测（Copy Detection, GPTZero, Turnitin等）
- 智能降重功能和相似度分析
- 人工风格优化建议
- 实时预览修改效果
- 生成优化报告

3. 格式规范化
- 支持多种论文格式（国标、硕博、期刊等）
- 支持上传和使用特定学校论文模板
- 自动格式修正
- 批量处理功能
- 导出标准文档
- 图表自动编号

4. PPT自动生成
- 支持多种模板风格
- 自动提取论文要点
- 智能排版布局
- 支持自定义修改
- 图表自动转换

5. 问卷设计
- 数据反向生成问卷
- 智能问题设计
- 多种题型支持
- 格式导出功能
- 数据分析报告

6. 批注处理功能
- 上传Word生成的带批注PDF文件
- 自动分析批注内容并修改对应文本
- 修改内容以绿色标记显示区分
- 支持下载修改后的文档
- 批注处理历史记录查询

7. 会员管理系统
- 基于额度控制的会员权限管理
- 支持设置生成次数和字数限制
- 会员级别与功能权限配置
- 额度使用统计和报表展示
- 支持手动调整会员额度

8. 多模型API密钥池管理
- 支持多种AI模型接口(OpenAI、DeepSeek、智谱AI、百度千帆等)
- 按教育级别匹配不同AI模型
- API密钥动态调度和负载均衡
- 密钥使用统计和监控
- 自定义API地址和参数配置

## 系统架构

本系统采用前后端分离的架构设计，分为Web服务端和客户端(EXE)两部分：

### 1. Web服务端
- 基于Flask框架开发的Web后台
- 提供REST API接口支持客户端调用
- 负责数据存储、用户认证、会员管理
- 处理API密钥池管理和调度
- Docker容器化部署支持

### 2. 客户端(EXE)
- 基于Python和Tkinter开发的桌面应用
- 与Web服务端通信获取配置和额度信息
- 本地缓存机制保障离线使用
- 自动更新支持
- 网络连通性检测

### 组件通信
- 客户端与Web服务端通过REST API通信
- 使用JWT令牌进行身份验证
- 支持断线重连和本地缓存
- 使用HTTPS加密传输确保安全性

## 技术特性

- 支持多种大语言模型API(OpenAI、DeepSeek、智谱AI、百度千帆等)
- 基于教育级别和任务类型的模型自动选择
- 异步处理机制提升性能
- 模块化架构设计
- 完整的错误处理机制
- 详细的日志记录系统
- SQLite数据库支持
- 文件缓存机制
- 多线程处理
- Docker容器化部署

## 系统要求

### Web服务端
- Python 3.8+
- Docker环境(推荐)
- 最小内存：2GB
- 推荐内存：4GB+
- 存储空间：500MB+
- 网络：公网IP或内网环境

### 客户端(EXE)
- Windows 10/11
- 最小内存：4GB
- 推荐内存：8GB+
- 存储空间：500MB+
- 网络：能够连接Web服务端

## 安装部署

### Web服务端部署(Docker)

1. 克隆仓库：
```bash
git clone https://github.com/yourusername/ai-text-generator.git
```

2. 配置环境变量：
复制`.env.example`文件为`.env`并根据需求修改：
```bash
cp env.example .env
```

关键配置项：
```
# 数据库配置
DATABASE_URI=sqlite:///data/app.db

# Web服务配置
SECRET_KEY=your-secret-key
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your-password

# 网络配置
REQUIRE_NETWORK=true
CHECK_API_ENDPOINTS=true
API_CHECK_TIMEOUT=10
```

3. 启动Docker容器：
```bash
docker-compose up -d
```

4. 访问Web管理界面：
打开浏览器访问`http://your-server-ip:5000/admin`，使用配置的管理员账号登录。

### 客户端(EXE)部署

1. 下载最新版本的客户端安装包
2. 运行安装程序，按照向导完成安装
3. 首次运行时配置Web服务器地址
4. 使用管理员提供的账号密码登录

也可以从源码构建：
```bash
# Windows环境
python build.bat

# Linux/MacOS环境
./build.sh
```

## 项目结构

```
ai-text-generator/
├── src/                      # 源代码目录
│   ├── main.py               # 主程序入口
│   ├── config/               # 配置文件
│   │   ├── settings.py       # 全局配置
│   │   └── client_config.py  # 客户端配置
│   ├── gui/                  # 图形界面模块
│   │   ├── app.py            # 主窗口
│   │   ├── pages/            # 功能页面
│   │   └── components/       # UI组件
│   ├── models/               # 核心功能模块
│   │   ├── paper_generator.py
│   │   ├── text_detector.py
│   │   ├── api_manager.py    # API管理器
│   │   ├── client_init.py    # 客户端初始化
│   │   └── annotation_processor.py # 批注处理器
│   ├── web/                  # Web服务端模块
│   │   ├── models.py         # 数据模型
│   │   ├── views.py          # 视图函数
│   │   ├── admin.py          # 管理界面
│   │   ├── api.py            # REST API
│   │   ├── forms.py          # 表单定义
│   │   └── templates/        # 网页模板
│   └── utils/                # 工具类
│       ├── database.py       # 数据库操作
│       ├── logger.py         # 日志工具
│       ├── file_handler.py   # 文件处理
│       ├── exceptions.py     # 异常定义
│       └── reference_generator.py # 参考文献生成器
├── templates/                # 论文模板目录
├── tests/                    # 测试文件
├── data/                     # 数据目录
├── logs/                     # 日志目录
├── docker-compose.yml        # Docker配置
├── Dockerfile                # Docker构建文件
├── build.bat                 # Windows构建脚本
├── build.sh                  # Linux/MacOS构建脚本
├── requirements.txt          # 依赖列表
├── requirements-web.txt      # Web服务端依赖
└── README.md                 # 项目说明
```

## 功能模块详解

### 批注处理功能
批注处理模块支持用户上传带有批注的PDF文件，系统会自动分析批注内容并根据批注修改对应文本。
1. 上传PDF文件：支持Word生成的带批注PDF文件
2. 自动提取批注：系统分析PDF提取批注内容和位置
3. 智能修改文本：根据批注内容自动修改相应段落
4. 绿色标记区分：修改的内容以绿色标记显示，便于区分
5. 下载修改后文档：支持导出修改后的文档

### API密钥池管理
系统支持多种AI大模型API，通过密钥池管理实现高效调度和负载均衡：
1. 多API支持：OpenAI、DeepSeek、智谱AI、百度千帆、讯飞星火等
2. 按优先级调度：可设置API密钥使用优先级
3. 自定义端点：支持自定义API地址和参数
4. 使用统计：记录每个密钥的使用次数和额度消耗
5. 模型匹配：根据教育级别和任务类型自动选择合适的模型

### 会员和额度管理
系统通过会员管理控制用户使用权限和生成额度：
1. 会员级别：支持设置多个会员级别，不同级别对应不同权限
2. 额度控制：按生成次数和字数限制用户使用
3. 额度消耗统计：记录和展示会员额度使用情况
4. 手动调整：管理员可手动调整会员额度
5. 过期控制：支持设置会员权限有效期

### 教育级别与模型匹配
根据不同教育级别自动选择合适的AI模型：
1. 教育级别划分：本科、硕士、博士等不同级别
2. 模型配置：为每个教育级别和任务类型配置最佳模型
3. 参数优化：根据任务类型自动设置模型参数
4. 质量保证：高级别教育任务使用更高级的模型

## 网络与安全

### 网络连通性检测
系统会自动检测网络连通性，确保在网络正常时才运行关键功能：
1. 网络连接检查：检测基本网络连接状态
2. API端点可用性：验证配置的API端点是否可访问
3. Web服务端连接：检查与Web服务端的连接状态
4. 断线重连：支持网络中断后自动重连
5. 离线模式：部分功能支持离线使用

### 安全机制
系统采用多种安全措施保护用户数据和API密钥：
1. HTTPS通信：客户端与Web服务端通过HTTPS加密通信
2. JWT认证：使用JWT令牌进行身份验证
3. 密钥加密存储：API密钥在数据库中加密保存
4. 输入验证：所有用户输入进行严格验证，防止注入攻击
5. CSRF防护：Web界面实现CSRF Token机制
6. 权限控制：基于角色的访问控制系统

## 错误处理与日志

系统实现了统一的错误处理机制和详细的日志记录：
1. 异常分类：ValidationError、APIError、DatabaseError、GenerationError等
2. 优雅降级：主要功能异常时有备选方案
3. 用户友好提示：将技术错误转换为用户友好的提示
4. 分级日志：按ERROR、WARNING、INFO等级别记录日志
5. 日志轮转：支持按大小或日期自动轮转日志文件

## 更新与维护

系统支持便捷的更新和维护机制：
1. 自动更新：客户端支持检测并下载安装新版本
2. 配置热更新：部分配置支持在运行时更新，无需重启
3. 数据备份：定期自动备份关键数据
4. 健康检查：Web服务端提供健康检查接口
5. 资源监控：记录CPU、内存使用情况

## 更新日志

### v2.0.0 (2024-07-15)
- 新增Web服务端与客户端分离架构
- 添加批注处理功能
- 实现会员与额度管理系统
- 支持多种AI模型API和密钥池管理
- 增加Docker容器化部署支持
- 优化网络连通性检测

### v1.2.0 (2024-07-01)
- 新增学校模板选择与上传功能
- 添加参考文献智能生成功能（支持多种格式）
- 优化论文生成结构（标题、中英文摘要、关键词、正文、参考文献、致谢）
- 改进异步生成机制，提高生成效率
- 修复已知BUG

### v1.1.0 (2024-06-15)
- 添加大纲交互式编辑功能
- 支持章节数据/表格配置
- 优化生成质量
- 改进用户界面交互

### v1.0.0 (2024-06-09)
- 初始版本发布
- 支持基础论文生成功能
- 完成GUI界面框架

## 常见问题

1. Web服务端与客户端连接问题
   - 确保网络环境允许客户端连接Web服务端
   - 检查Web服务端是否正常运行
   - 验证用户名和密码是否正确

2. API 配置问题
   - 确保API密钥正确配置
   - 检查网络连接状态
   - 查看API调用限制

3. 字数限制说明
   - 单次生成最大支持50000字
   - 建议每节不超过3000字
   - 支持分批次生成

4. 批注处理问题
   - 仅支持Word生成的PDF文件中的批注
   - 确保PDF文件未加密
   - 批注位置需明确指向需要修改的文本

5. Docker部署问题
   - 确保Docker和Docker Compose已正确安装
   - 检查端口映射配置
   - 确认环境变量设置正确

6. 会员额度问题
   - 额度不足时无法生成内容
   - 联系管理员增加额度
   - 查看会员到期时间

## 联系方式

- Email: your.email@example.com
- Issues: github.com/yourusername/ai-text-generator/issues
- 文档：docs.ai-text-generator.com